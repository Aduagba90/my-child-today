<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Attendance - My Child Today</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <!-- Shared dashboard CSS -->
  <link rel="stylesheet" href="css/dashboard.css">

  <style>

    /* ===== MOBILE READABILITY FIX ===== */
@media (max-width: 768px) {

  body {
    font-size: 14px !important;
  }

  .content {
    padding: 14px !important;
  }

  .table th, .table td {
    font-size: 13px !important;
    padding: 8px 6px !important;
  }

  .sidebar {
    width: 220px !important;
  }

  h1, h2, h3 {
    font-size: 16px !important;
  }

  .badge {
    font-size: 12px !important;
  }

  button, .btn {
    font-size: 13px !important;
  }

}


    /* ===== MOBILE HAMBURGER SIDEBAR ===== */
@media (max-width: 768px) {
  .sidebar {
    position: fixed;
    top: 0;
    left: 0;
    height: 100%;
    width: 240px;
    transform: translateX(-100%);
    transition: transform 0.3s ease;
    z-index: 1050;
  }

  .sidebar.mobile-visible {
    transform: translateX(0);
  }

  .content {
    margin-left: 0 !important;
  }
}

@media (max-width: 768px) {

  .filters-row {
    flex-direction: column;
    align-items: stretch;
    gap: 10px;
  }

  .summary-badges {
    justify-content: flex-end;
    width: 100%;
  }

}

@media (max-width: 768px) {

  .content h3 {
    font-size: 14px !important;
  }

}




    .content { padding-bottom: 40px; }

    .search-row {
  width: 100%;
  max-width: 520px;
}

@media (max-width: 768px) {
  .search-row {
    max-width: 100%;
    min-width: 0;
  }
}


    .filters-row .form-select { min-width: 180px; }
    .filters-row .btn { white-space: nowrap; }
    .summary-badges .badge { font-weight: 600; padding: 8px 10px; border-radius: 8px; }
    .summary-badges .present-badge { background: #d4f5df; color: #1E5128; }
    .summary-badges .absent-badge { background: #ffe6e6; color: #b02a37; }
    .table thead th { background-color: #f1f5f1; }
    .action-edit { color: #0d6efd; font-weight: 600; text-decoration: none; cursor: pointer; }
    .action-edit:hover { text-decoration: underline; }

    @media (max-width: 992px) {
      .search-row { max-width: 100%; }
      .filters-row { flex-direction: column; align-items: flex-start; gap: 0.75rem; }
      .summary-badges { margin-top: .75rem; }
    }

    /* --------------------------------------
Global Font & Layout Adjustments
--------------------------------------- */
body, .sidebar, .content, .card, .table, button, a, h1, h2, h3, h4, h5, h6, p, span, td, th {
  font-size: 11px !important;
  line-height: 1.2 !important;
  font-family: 'Roboto', sans-serif;
  color: #333;
}

/* Headings slightly larger for clarity */
h1, h2, h3 {
  font-size: 13px !important;
  font-weight: 600 !important;
}

/* --------------------------------------
Sidebar Styling (Fixed + Gray Theme)
--------------------------------------- */
.sidebar {
  width: 190px !important;
  min-height: 100vh;
  height: 100%;
  position: fixed;
  top: 0;
  left: 0;
  overflow-y: auto;
  background-color: #2f3e46;
  color: #fff !important;
  z-index: 100;
  padding-top: 1rem;
  display: flex;
  flex-direction: column;
}


/* Sidebar Header */
.sidebar .sidebar-header {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-bottom: 0.8rem;
  padding: 0 10px;
}
.sidebar .sidebar-header span {
  font-size: 11px !important;
  font-weight: 600;
  color: #fff !important;
}

/* Sidebar Links */
.sidebar .nav-links {
  flex-grow: 1;
}
.sidebar .nav-link {
  display: flex;
  align-items: center;
  font-size: 10.5px !important;
  padding: 6px 10px !important;
  border-radius: 6px;
  color: #e0e0e0 !important;
  transition: background 0.25s ease, color 0.25s ease;
}
.sidebar .nav-link i {
  font-size: 13px !important;
  margin-right: 6px;
}

/* Active or Hover States */
.sidebar .nav-link:hover,
.sidebar .nav-link.active {
  background-color: #009688; /* teal-blue highlight */
  color: #fff !important;
}

/* --------------------------------------
Logout Button (Bottom of Sidebar)
--------------------------------------- */
.logout-section {
  padding: 0.5rem 10px !important;
  width: 100%;
  border-top: 1px solid rgba(255, 255, 255, 0.2);
}
.logout-btn {
  font-size: 10px !important;
  padding: 5px 8px !important;
  border-radius: 5px !important;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 4px;
  width: 100%;
  background-color: #dc3545;
  color: #fff !important;
  border: none;
  transition: background 0.2s ease;
}
.logout-btn i {
  font-size: 12px !important;
}
.logout-btn:hover {
  background-color: #c82333;
}

/* --------------------------------------
Dashboard Content Area
--------------------------------------- */
.content {
  margin-left: 190px;
  padding: 1rem !important;
  font-size: 11px !important;
  background-color: #f8f9fa;
  min-height: 100vh;
}

/* --------------------------------------
Cards and Stats
--------------------------------------- */
.card {
  padding: 0.6rem !important;
  border-radius: 8px !important;
  box-shadow: 0 1px 4px rgba(0,0,0,0.05);
  background-color: #fff;
}
.stat-card h6 {
  font-size: 10px !important;
}
.stat-card h3 {
  font-size: 15px !important;
}
.stat-icon {
  font-size: 1.2rem !important;
}

/* --------------------------------------
Tables
--------------------------------------- */
.table th, .table td {
  font-size: 10px !important;
  padding: 4px 6px !important;
  vertical-align: middle !important;
}
.table th {
  font-weight: 600 !important;
}

/* --------------------------------------
Charts
--------------------------------------- */
.chart-container {
  font-size: 10px !important;
}
canvas {
  max-height: 180px !important;
}

/* --------------------------------------
Floating CTA
--------------------------------------- */
.floating-cta {
  font-size: 10.5px !important;
  padding: 7px 12px !important;
  border-radius: 30px !important;
  position: fixed;
  bottom: 25px;
  right: 25px;
  z-index: 200;
  background-color: #009688;
  color: #fff;
  border: none;
  transition: background 0.25s ease;
}
.floating-cta:hover {
  background-color: #00796b;
}

/* --------------------------------------
Alignment Cleanup
--------------------------------------- */
.row, .col-md-4, .col-md-6 {
  margin: 0 !important;
  padding: 0.3rem !important;
}
  </style>
</head>
<body>
  <div class="d-flex">
    <!-- Sidebar -->
    <nav class="sidebar">
      <div class="sidebar-header d-flex align-items-center mb-4">
        <i class="bi bi-mortarboard-fill sidebar-icon"></i>
        <span class="fw-bold">School Admin</span>
      </div>

      <ul class="nav flex-column px-3">
        <li class="nav-item"><a href="dashboard.html" class="nav-link"><i class="bi bi-speedometer2 me-2"></i>Dashboard</a></li>
        <li class="nav-item"><a href="students.html" class="nav-link"><i class="bi bi-people me-2"></i>Students</a></li>
        <li class="nav-item"><a href="attendance.html" class="nav-link active"><i class="bi bi-check-circle me-2"></i>Attendance</a></li>
        <li class="nav-item"><a href="sms.html" class="nav-link"><i class="bi bi-chat-dots me-2"></i>SMS</a></li>
        <li class="nav-item"><a href="reports.html" class="nav-link"><i class="bi bi-graph-up me-2"></i>Reports</a></li>
      </ul>

      <div class="logout-section mt-auto px-3 mb-3">
        <button id="logoutBtn" class="logout-btn w-100"><i class="bi bi-box-arrow-right me-2"></i>Logout</button>
      </div>
    </nav>

    <!-- Main content -->
    <main class="content flex-grow-1 p-4">
      <!-- Mobile Top Bar (for small screens) -->
        <div class="d-md-none d-flex align-items-center mb-3">
          <button id="sidebarToggle" class="btn btn-light border me-2">
            <i class="bi bi-list fs-4"></i>
          </button>
          <span class="fw-bold">Attendance</span>
        </div>

      <!-- Search bar -->
      <div class="mb-2">
        <div class="input-group search-row">
          <span class="input-group-text bg-white border-end-0"><i class="bi bi-search text-muted"></i></span>
          <input id="searchInput" type="text" class="form-control border-start-0" placeholder="Search students..." aria-label="Search students">
        </div>
      </div>
      <hr>

      <!-- Header row -->
      <div class="d-flex justify-content-between align-items-start mb-4 flex-nowrap">
        <div>
          <h3 class="fw-bold mb-1">Attendance</h3>
          <p class="text-muted mb-0">Manage student attendance for today</p>
        </div>
        <div class="text-end mt-2">
          <div class="d-flex align-items-center justify-content-end">
            <i class="bi bi-calendar-date text-success me-2 fs-5"></i>
            <div id="currentDate" class="fw-semibold text-muted"></div>
          </div>
        </div>
      </div>

      <!-- Filters row -->
      <div class="d-flex justify-content-between align-items-center mb-4 filters-row flex-wrap">
        <div class="d-flex align-items-center gap-2">
          <select id="classSelect" class="form-select">
            <option value="all">All Classes</option>
            <option value="jss1a">JSS 1A</option>
            <option value="jss2a">JSS 2A</option>
            <option value="sss1a">SSS 1A</option>
            <option value="sss1b">SSS 1B</option>
          </select>

          <select id="subjectSelect" class="form-select">
            <option value="all">All Subjects</option>
            <option value="mathematics">Mathematics</option>
            <option value="english">English</option>
            <option value="science">Science</option>
            <option value="social">Social Studies</option>
          </select>

          <button id="filterBtn" class="btn btn-success">Filter</button>
          <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#markAttendanceModal">
            <i class="bi bi-plus-circle me-1"></i>Mark Attendance
          </button>
        </div>

        <div class="summary-badges d-flex align-items-center gap-3">
          <div class="present-badge badge"><span class="me-2">ðŸŸ¢</span> Present: <span id="presentCount" class="ms-1">28</span></div>
          <div class="absent-badge badge"><span class="me-2">ðŸ”´</span> Absent: <span id="absentCount" class="ms-1">2</span></div>
        </div>
      </div>

      <!-- Table -->
      <div class="card shadow-sm p-3">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h6 class="fw-bold mb-0">Student Attendance</h6>
        </div>

        <div class="table-responsive" style="max-height:520px; overflow:auto;">
          <table id="attendanceTable" class="table table-hover align-middle mb-0">
            <thead class="table-light">
              <tr>
                <th>Student Name</th>
                <th>Status</th>
                <th>Notes</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr data-class="jss1a" data-subject="mathematics">
                <td>Aliyu Musa</td>
                <td><span class="badge bg-success">Present</span></td>
                <td>On time</td>
                <td><a class="action-edit">Edit</a></td>
              </tr>
              <tr data-class="jss1a" data-subject="english">
                <td>Maryam Bello</td>
                <td><span class="badge bg-danger">Absent</span></td>
                <td>Family emergency</td>
                <td><a class="action-edit">Edit</a></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </main>
  </div>

  <!-- Mark Attendance Modal -->
  <div class="modal fade" id="markAttendanceModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title"><i class="bi bi-check2-square me-2"></i>Mark Attendance</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="attendanceForm">
            <div class="mb-3">
              <label class="form-label">Student Name</label>
              <input type="text" class="form-control" id="studentNameInput" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Class</label>
              <select id="classInput" class="form-select" required>
                <option>JSS 1A</option>
                <option>JSS 2A</option>
                <option>SSS 1A</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">Subject</label>
              <select id="subjectInput" class="form-select" required>
                <option>Mathematics</option>
                <option>English</option>
                <option>Science</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">Status</label>
              <select id="statusInput" class="form-select" required>
                <option>Present</option>
                <option>Absent</option>
                <option>Late</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">Notes</label>
              <textarea id="notesInput" class="form-control" rows="2"></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button class="btn btn-success" id="saveAttendanceBtn">Save</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Edit Attendance Modal -->
  <div class="modal fade" id="editAttendanceModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header bg-success text-white">
          <h5 class="modal-title"><i class="bi bi-pencil-square me-2"></i>Edit Attendance</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="editAttendanceForm">
            <input type="hidden" id="editRowIndex">
            <div class="mb-3">
              <label class="form-label">Student Name</label>
              <input type="text" class="form-control" id="editStudentName" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Status</label>
              <select id="editStatus" class="form-select" required>
                <option>Present</option>
                <option>Absent</option>
                <option>Late</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">Notes</label>
              <textarea id="editNotes" class="form-control" rows="2"></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button class="btn btn-success" id="updateAttendanceBtn">Update</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    const table = document.querySelector('#attendanceTable tbody');
    const presentCount = document.getElementById('presentCount');
    const absentCount = document.getElementById('absentCount');

    function updateCounts() {
      let present = 0, absent = 0;
      [...table.rows].forEach(r => {
        const status = r.cells[1].innerText.toLowerCase();
        if (status.includes('present')) present++;
        if (status.includes('absent')) absent++;
      });
      presentCount.textContent = present;
      absentCount.textContent = absent;
    }

    // Mark attendance
    document.getElementById('saveAttendanceBtn').addEventListener('click', () => {
      const name = document.getElementById('studentNameInput').value;
      const status = document.getElementById('statusInput').value;
      const notes = document.getElementById('notesInput').value;

      if (!name) return;
      const row = table.insertRow();
      row.innerHTML = `
        <td>${name}</td>
        <td><span class="badge ${status==='Present'?'bg-success':status==='Absent'?'bg-danger':'bg-warning text-dark'}">${status}</span></td>
        <td>${notes || 'â€”'}</td>
        <td><a class="action-edit">Edit</a></td>
      `;
      bootstrap.Modal.getInstance(document.getElementById('markAttendanceModal')).hide();
      document.getElementById('attendanceForm').reset();
      updateCounts();
    });

    // Edit attendance
    table.addEventListener('click', e => {
      if (e.target.classList.contains('action-edit')) {
        const row = e.target.closest('tr');
        const index = [...table.rows].indexOf(row);
        document.getElementById('editRowIndex').value = index;
        document.getElementById('editStudentName').value = row.cells[0].innerText;
        document.getElementById('editStatus').value = row.cells[1].innerText.trim();
        document.getElementById('editNotes').value = row.cells[2].innerText;
        new bootstrap.Modal('#editAttendanceModal').show();
      }
    });

    document.getElementById('updateAttendanceBtn').addEventListener('click', () => {
      const i = document.getElementById('editRowIndex').value;
      const name = document.getElementById('editStudentName').value;
      const status = document.getElementById('editStatus').value;
      const notes = document.getElementById('editNotes').value;
      if (i === '') return;
      const row = table.rows[i];
      row.cells[0].innerText = name;
      row.cells[1].innerHTML = `<span class="badge ${status==='Present'?'bg-success':status==='Absent'?'bg-danger':'bg-warning text-dark'}">${status}</span>`;
      row.cells[2].innerText = notes || 'â€”';
      bootstrap.Modal.getInstance(document.getElementById('editAttendanceModal')).hide();
      updateCounts();
    });

    // Logout confirmation
    document.getElementById('logoutBtn').addEventListener('click', () => {
      const confirmLogout = confirm('Are you sure you want to logout?');
      if (confirmLogout) {
        window.location.href = '../login.html';
      }
    });

    // Set current date
    document.getElementById('currentDate').textContent = new Date().toLocaleDateString();

    updateCounts();
  </script>

<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-analytics.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyDPyFdoFh6kpsnJ9IMrGAvs8egNLkjQe-o",
    authDomain: "my-child-today-f6c24.firebaseapp.com",
    projectId: "my-child-today-f6c24",
    storageBucket: "my-child-today-f6c24.firebasestorage.app",
    messagingSenderId: "84678623630",
    appId: "1:84678623630:web:1bc4cfc1890b41bbe4e4df",
    measurementId: "G-VHSY73TL0V"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
</script>

<script>
const sidebar = document.querySelector('.sidebar');
const sidebarToggle = document.getElementById('sidebarToggle');

// Toggle sidebar visibility on click
sidebarToggle?.addEventListener('click', () => {
  sidebar.classList.toggle('mobile-visible');
});

// Close sidebar when clicking outside
document.addEventListener('click', function(e) {
  if (window.innerWidth < 768) {
    if (
      sidebar &&
      sidebarToggle &&
      !sidebar.contains(e.target) &&
      !sidebarToggle.contains(e.target)
    ) {
      sidebar.classList.remove('mobile-visible');
    }
  }
});
</script>


</body>
</html>
