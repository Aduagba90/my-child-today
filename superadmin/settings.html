<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Settings - Super Admin | My Child Today</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <!-- Shared Dashboard CSS -->
  <link rel="stylesheet" href="../schooladmin/css/dashboard.css">

  <style>
    :root {
      --mct-green: #198754;
      --mct-bg: #ffffff;
      --mct-text: #212529;
    }

    body.mct-dark {
      --mct-bg: #0f1720;
      --mct-text: #e6eef5;
    }

    body {
      background-color: var(--mct-bg);
      color: var(--mct-text);
      transition: background-color .2s, color .2s;
    }

    .settings-wrapper { max-width: 1100px; margin: 0 auto; }
    .card.profile-card { border-radius: 12px; }
    .profile-photo {
      width: 120px; height: 120px; border-radius: 50%;
      object-fit: cover; border: 3px solid var(--mct-green); cursor: pointer;
      transition: transform .15s;
      background: #f4f6f8;
    }
    .profile-photo:hover { transform: scale(1.05); }
    .sidebar-profile {
      width:36px;height:36px;border-radius:50%;object-fit:cover;border:2px solid rgba(255,255,255,0.2);
    }

    @media (max-width: 992px) {
      .col-left, .col-right { width: 100%; }
    }

    .toast-success .toast-body { background: var(--mct-green); color: #fff; }

     /* --------------------------------------
Global Font & Layout Adjustments
--------------------------------------- */
body, .sidebar, .content, .card, .table, button, a, h1, h2, h3, h4, h5, h6, p, span, td, th {
  font-size: 11px !important;
  line-height: 1.2 !important;
  font-family: 'Roboto', sans-serif;
  color: #333;
}

/* Headings slightly larger for clarity */
h1, h2, h3 {
  font-size: 13px !important;
  font-weight: 600 !important;
}

/* --------------------------------------
Sidebar Styling (Fixed + Gray Theme)
--------------------------------------- */
.sidebar {
  width: 190px !important;
  height: 100vh;
  position: fixed;
  top: 0;
  left: 0;
  overflow-y: auto;
  background-color: #2f3e46; /* elegant gray-blue tone */
  color: #fff !important;
  z-index: 100;
  padding-top: 1rem;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

/* Sidebar Header */
.sidebar .sidebar-header {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-bottom: 0.8rem;
  padding: 0 10px;
}
.sidebar .sidebar-header span {
  font-size: 11px !important;
  font-weight: 600;
  color: #fff !important;
}

/* Sidebar Links */
.sidebar .nav-links {
  flex-grow: 1;
}
.sidebar .nav-link {
  display: flex;
  align-items: center;
  font-size: 10.5px !important;
  padding: 6px 10px !important;
  border-radius: 6px;
  color: #e0e0e0 !important;
  transition: background 0.25s ease, color 0.25s ease;
}
.sidebar .nav-link i {
  font-size: 13px !important;
  margin-right: 6px;
}

/* Active or Hover States */
.sidebar .nav-link:hover,
.sidebar .nav-link.active {
  background-color: #009688; /* teal-blue highlight */
  color: #fff !important;
}

/* --------------------------------------
Logout Button (Bottom of Sidebar)
--------------------------------------- */
.logout-section {
  padding: 0.5rem 10px !important;
  width: 100%;
  border-top: 1px solid rgba(255, 255, 255, 0.2);
}
.logout-btn {
  font-size: 10px !important;
  padding: 5px 8px !important;
  border-radius: 5px !important;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 4px;
  width: 100%;
  background-color: #dc3545;
  color: #fff !important;
  border: none;
  transition: background 0.2s ease;
}
.logout-btn i {
  font-size: 12px !important;
}
.logout-btn:hover {
  background-color: #c82333;
}

/* --------------------------------------
Dashboard Content Area
--------------------------------------- */
.content {
  margin-left: 190px;
  padding: 1rem !important;
  font-size: 11px !important;
  background-color: #f8f9fa;
  min-height: 100vh;
}

/* --------------------------------------
Cards and Stats
--------------------------------------- */
.card {
  padding: 0.6rem !important;
  border-radius: 8px !important;
  box-shadow: 0 1px 4px rgba(0,0,0,0.05);
  background-color: #fff;
}
.stat-card h6 {
  font-size: 10px !important;
}
.stat-card h3 {
  font-size: 15px !important;
}
.stat-icon {
  font-size: 1.2rem !important;
}

/* --------------------------------------
Tables
--------------------------------------- */
.table th, .table td {
  font-size: 10px !important;
  padding: 4px 6px !important;
  vertical-align: middle !important;
}
.table th {
  font-weight: 600 !important;
}

/* --------------------------------------
Charts
--------------------------------------- */
.chart-container {
  font-size: 10px !important;
}
canvas {
  max-height: 180px !important;
}

/* --------------------------------------
Floating CTA
--------------------------------------- */
.floating-cta {
  font-size: 10.5px !important;
  padding: 7px 12px !important;
  border-radius: 30px !important;
  position: fixed;
  bottom: 25px;
  right: 25px;
  z-index: 200;
  background-color: #009688;
  color: #fff;
  border: none;
  transition: background 0.25s ease;
}
.floating-cta:hover {
  background-color: #00796b;
}

/* --------------------------------------
Alignment Cleanup
--------------------------------------- */
.row, .col-md-4, .col-md-6 {
  margin: 0 !important;
  padding: 0.3rem !important;
}
  </style>
</head>
<body>
  <div class="d-flex">
    <nav class="sidebar">
      <div class="sidebar-header d-flex align-items-center mb-4">
        <img id="sidebarThumb" src="../assets/images/superadmin.jpeg" alt="thumb" class="sidebar-profile me-2">
        <span id="sidebarName">Super Admin</span>
      </div>
      <ul class="nav flex-column px-3">
        <li class="nav-item"><a href="dashboard.html" class="nav-link"><i class="bi bi-speedometer2 me-2"></i>Dashboard</a></li>
        <li class="nav-item"><a href="schools.html" class="nav-link"><i class="bi bi-building me-2"></i>Manage Schools</a></li>
        <li class="nav-item"><a href="admins.html" class="nav-link"><i class="bi bi-person-gear me-2"></i>School Admins</a></li>
        <li class="nav-item"><a href="reports.html" class="nav-link"><i class="bi bi-graph-up me-2"></i>Reports</a></li>
        <li class="nav-item"><a href="settings.html" class="nav-link active"><i class="bi bi-gear me-2"></i>Settings</a></li>
      </ul>
      <div class="logout-section mt-auto px-3 mb-3">
        <button class="logout-btn w-100 btn btn-danger" id="logoutBtn">
          <i class="bi bi-box-arrow-right me-2"></i>Logout
        </button>
      </div>
    </nav>

    <main class="content flex-grow-1 p-4">
      <div class="settings-wrapper">
        <div class="d-flex justify-content-between align-items-start mb-2">
          <div>
            <h2 class="fw-bold mb-1">Settings & Profile</h2>
            <p class="text-muted mb-0">Manage account, security and system preferences.</p>
          </div>
          <div>
            <a href="dashboard.html" class="btn btn-outline-secondary"><i class="bi bi-arrow-left me-2"></i>Back to Dashboard</a>
          </div>
        </div>

        <hr class="my-3">

        <div class="row g-4">
          <div class="col-lg-6 col-left">
            <div class="card profile-card shadow-sm p-4">
              <div class="text-center">
                <!-- ✅ Default Super Admin photo -->
                <img id="profileImage" class="profile-photo mb-2" src="../assets/images/superadmin.jpeg" alt="Profile Photo">
                <input id="photoInput" type="file" accept="image/*" hidden>
                <p class="small text-muted mb-3">Click the photo to upload; it will be saved in your browser.</p>
              </div>

              <form id="profileForm" autocomplete="off">
                <div class="mb-3">
                  <label class="form-label fw-semibold">Full name</label>
                  <input id="fullName" class="form-control" placeholder="Your full name">
                </div>

                <div class="mb-3">
                  <label class="form-label fw-semibold">Email</label>
                  <input id="email" type="email" class="form-control" placeholder="you@school.edu">
                </div>

                <div class="mb-3">
                  <label class="form-label fw-semibold">Phone</label>
                  <input id="phone" class="form-control" placeholder="+234 800 000 0000">
                </div>

                <div class="mb-3">
                  <label class="form-label fw-semibold">Role</label>
                  <input id="role" class="form-control" value="Super Admin" readonly>
                </div>

                <hr>

                <h6 class="fw-bold">Change Password</h6>
                <div class="mb-3">
                  <label class="form-label">Current password</label>
                  <input id="currentPassword" type="password" class="form-control">
                </div>
                <div class="mb-3">
                  <label class="form-label">New password</label>
                  <input id="newPassword" type="password" class="form-control">
                </div>
                <div class="mb-3">
                  <label class="form-label">Confirm new password</label>
                  <input id="confirmPassword" type="password" class="form-control">
                </div>

                <div class="d-grid gap-2">
                  <button id="saveProfileBtn" type="button" class="btn btn-success">Save Profile</button>
                  <button id="changePasswordBtn" type="button" class="btn btn-outline-primary">Change Password</button>
                </div>
              </form>
            </div>
          </div>

          <div class="col-lg-6 col-right">
            <div class="card shadow-sm p-4">
              <h6 class="fw-bold mb-3">System Preferences</h6>

              <div class="mb-3 d-flex justify-content-between align-items-center">
                <div>
                  <div class="fw-semibold">Theme</div>
                  <div class="text-muted small">Light / Dark</div>
                </div>
                <div class="form-check form-switch">
                  <input id="themeSwitch" class="form-check-input" type="checkbox">
                </div>
              </div>

              <div class="mb-3 d-flex justify-content-between align-items-center">
                <div>
                  <div class="fw-semibold">Email Notifications</div>
                  <div class="text-muted small">Receive system emails</div>
                </div>
                <div class="form-check form-switch">
                  <input id="emailNotifSwitch" class="form-check-input" type="checkbox">
                </div>
              </div>

              <div class="mb-3 d-flex justify-content-between align-items-center">
                <div>
                  <div class="fw-semibold">SMS Notifications</div>
                  <div class="text-muted small">Receive important SMS alerts</div>
                </div>
                <div class="form-check form-switch">
                  <input id="smsNotifSwitch" class="form-check-input" type="checkbox">
                </div>
              </div>

              <div class="mb-3">
                <label class="form-label fw-semibold">Auto logout</label>
                <select id="autoLogout" class="form-select">
                  <option value="5">5 minutes</option>
                  <option value="15">15 minutes</option>
                  <option value="30">30 minutes</option>
                  <option value="0">Never</option>
                </select>
                <div class="small text-muted mt-1">Automatically log out after inactivity.</div>
              </div>

              <div class="d-grid gap-2 mt-3">
                <button id="savePrefsBtn" class="btn btn-primary">Save Preferences</button>
              </div>
            </div>

            <div class="card shadow-sm p-4 mt-4">
              <h6 class="fw-bold mb-3">System Management</h6>
              <div class="d-flex flex-wrap gap-2">
                <button id="backupBtn" class="btn btn-outline-primary"><i class="bi bi-arrow-clockwise me-2"></i>Backup Data</button>
                <button id="clearCacheBtn" class="btn btn-outline-danger"><i class="bi bi-trash3 me-2"></i>Clear Cache</button>
                <button id="syncBtn" class="btn btn-outline-success"><i class="bi bi-cloud-upload me-2"></i>Sync with Server</button>
              </div>
              <p class="small text-muted mt-3">Note: these buttons are simulated and intended to call backend endpoints in a real app.</p>
            </div>
          </div>
        </div>

        <div class="card shadow-sm p-3 mt-4">
          <h6 class="fw-bold mb-3">Recent Activity</h6>
          <div class="table-responsive">
            <table class="table table-sm align-middle">
              <thead class="table-light">
                <tr><th>Date</th><th>Action</th><th>Status</th></tr>
              </thead>
              <tbody id="activityLog"></tbody>
            </table>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Toasts -->
  <div class="position-fixed top-0 end-0 p-3" style="z-index:1200;">
    <div id="toastSuccess" class="toast text-bg-success border-0" role="alert">
      <div class="d-flex"><div class="toast-body">Saved successfully.</div><button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button></div>
    </div>
    <div id="toastInfo" class="toast text-bg-info border-0" role="alert">
      <div class="d-flex"><div class="toast-body">Action completed.</div><button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button></div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
  function showToast(msg, which='success') {
    const toastEl = document.getElementById(which === 'info' ? 'toastInfo' : 'toastSuccess');
    toastEl.querySelector('.toast-body').textContent = msg;
    new bootstrap.Toast(toastEl).show();
  }

  function logActivity(action, status='Success') {
    const tbody = document.getElementById('activityLog');
    const tr = document.createElement('tr');
    const now = new Date().toLocaleString();
    tr.innerHTML = `<td>${now}</td><td>${action}</td><td>${status}</td>`;
    tbody.prepend(tr);
  }

  function loadState() {
    const savedPhoto = localStorage.getItem('mct_profilePhoto');
    const profileImage = document.getElementById('profileImage');
    const sidebarThumb = document.getElementById('sidebarThumb');
    // ✅ Load saved or default photo
    if (savedPhoto) {
      profileImage.src = savedPhoto;
      sidebarThumb.src = savedPhoto;
    } else {
      profileImage.src = "../assets/images/superadmin.jpeg";
      sidebarThumb.src = "../assets/images/superadmin.jpeg";
    }

    const name = localStorage.getItem('mct_fullName');
    const email = localStorage.getItem('mct_email');
    const phone = localStorage.getItem('mct_phone');
    if (name) document.getElementById('fullName').value = name;
    if (email) document.getElementById('email').value = email;
    if (phone) document.getElementById('phone').value = phone;
    if (name) document.getElementById('sidebarName').textContent = name;

    const theme = localStorage.getItem('mct_theme');
    if (theme === 'dark') {
      document.body.classList.add('mct-dark');
      document.getElementById('themeSwitch').checked = true;
    }

    document.getElementById('emailNotifSwitch').checked = localStorage.getItem('mct_emailNotif') === 'true';
    document.getElementById('smsNotifSwitch').checked = localStorage.getItem('mct_smsNotif') === 'true';
    document.getElementById('autoLogout').value = localStorage.getItem('mct_autoLogout') || '15';
  }

  // Upload photo
  document.getElementById('profileImage').addEventListener('click', () => document.getElementById('photoInput').click());
  document.getElementById('photoInput').addEventListener('change', e => {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = () => {
      const imgSrc = reader.result;
      document.getElementById('profileImage').src = imgSrc;
      document.getElementById('sidebarThumb').src = imgSrc;
      localStorage.setItem('mct_profilePhoto', imgSrc);
      showToast('Profile photo saved!');
      logActivity('Profile photo updated');
    };
    reader.readAsDataURL(file);
  });

  // Save Profile
  document.getElementById('saveProfileBtn').addEventListener('click', () => {
    const name = fullName.value.trim(), email = email.value.trim(), phone = phone.value.trim();
    if (!name || !email || !phone) return alert('Please fill all fields!');
    localStorage.setItem('mct_fullName', name);
    localStorage.setItem('mct_email', email);
    localStorage.setItem('mct_phone', phone);
    sidebarName.textContent = name;
    showToast('Profile saved successfully!');
    logActivity('Profile information saved');
  });

  // Change Password
  document.getElementById('changePasswordBtn').addEventListener('click', () => {
    const current = currentPassword.value, newP = newPassword.value, confirmP = confirmPassword.value;
    if (!current || !newP || !confirmP) return alert('All password fields required!');
    if (newP !== confirmP) return alert('Passwords do not match!');
    showToast('Password changed successfully!', 'info');
    logActivity('Password changed');
  });

  // Save Preferences
  document.getElementById('savePrefsBtn').addEventListener('click', () => {
    localStorage.setItem('mct_theme', document.getElementById('themeSwitch').checked ? 'dark' : 'light');
    localStorage.setItem('mct_emailNotif', document.getElementById('emailNotifSwitch').checked);
    localStorage.setItem('mct_smsNotif', document.getElementById('smsNotifSwitch').checked);
    localStorage.setItem('mct_autoLogout', document.getElementById('autoLogout').value);
    showToast('Preferences saved!');
    logActivity('System preferences saved');
  });

  // Backup
  document.getElementById('backupBtn').addEventListener('click', () => {
    showToast('Backing up data...', 'info');
    setTimeout(() => {
      showToast('Backup completed successfully!');
      logActivity('Data backup completed');
    }, 1500);
  });

  // Clear Cache
  document.getElementById('clearCacheBtn').addEventListener('click', () => {
    if (confirm('Are you sure you want to clear all saved data?')) {
      localStorage.clear();
      showToast('Cache cleared successfully!');
      logActivity('Cache cleared');
      setTimeout(() => location.reload(), 1000);
    }
  });

  // Sync
  document.getElementById('syncBtn').addEventListener('click', () => {
    showToast('Syncing with server...', 'info');
    setTimeout(() => {
      showToast('Data synced successfully!');
      logActivity('Data synced with server');
    }, 2000);
  });

  // Theme toggle
  document.getElementById('themeSwitch').addEventListener('change', e => {
    if (e.target.checked) {
      document.body.classList.add('mct-dark');
      localStorage.setItem('mct_theme', 'dark');
    } else {
      document.body.classList.remove('mct-dark');
      localStorage.setItem('mct_theme', 'light');
    }
    logActivity('Theme changed to ' + (e.target.checked ? 'Dark' : 'Light'));
  });

  // Logout Confirmation + Redirect
  document.getElementById('logoutBtn').addEventListener('click', function() {
    const confirmLogout = confirm('Are you sure you want to logout?');
    if (confirmLogout) {
      // Optional: clear saved data if desired
      // localStorage.removeItem('mct_fullName');
      // localStorage.removeItem('mct_profilePhoto');
      // localStorage.removeItem('mct_theme');
      window.location.href = '../login.html';
    }
  });

  window.addEventListener('DOMContentLoaded', loadState);
  </script>
</body>
</html>
